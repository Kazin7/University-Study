ARP 스푸핑 공격
-사용자 A의 Arp table에 있는 사용자 B의 IP/Mac Address를 Mac만 공격자의 Mac Address로 변경하여
B로 가는 패킷을 공격자가 받아서 릴레이 시켜주는 것

fragrouter : 패킷이 원래 목적한 곳으로 가도록 패킷 릴레이 작동시킨다.

Ping of Death
-ICMP 패킷을 최대 길이로 설정
-전송을 하기 위해서 적절한 크기로 패킷을 자동 분할

DoS(Denial of Service)
-공격 대상이 수용할 수 있는 능력 이상의 정보를 제공하거나 사용자 또는 네트워크 용량을 초과시켜
정상적으로 작동하지 못하게 하는 공격

DoS공격 특징
-파괴공격 : 디스크,데이터,시스템 파괴
-시스템 자원 고갈 공격 : CPU,메모리
-네트워크 자원 고갈 공격 : 쓰레기 데이터로 네트워크 대역폭을 고갈시킨다.
-주로 UDP,ICMP프로토콜을 사용한다.
-공격 시, 위조된 큰 크기의 패킷으로 구성하며, Source IP를 위조한다.

-SYN Flooding : 서버별로 한정되어 있는 접속 가능 공간에 존재하지 않는 클라이언트가 접속한 것처럼 속여 
다른 사용자가 서비스를 제공받지 못하게 하는 것.
hping3사용하여 수행한다.
1. 공격자가 많은 숫자의 SYN패킷을 서버에 보낸다.
2. 서버는 받은 SYN패킷에 대해 SYN/ACK패킷을 각 클라이언트로 보낸다.
3. 서버는 보낸 SYN/ACK패킷에 대한 ACK를 받지 못한다.
4. 서버는 세션의 연결을 기다리게 된다.

SYN Flooding 보안 대책
1.시스템 패치 업데이트
2. 침입 탐지 시스템 및 침입 차단 시스템 설치
3. 짧은 시간 안에 똑같은 형태의 패킷을 보내는 공격을 인지하면, 그에 해당하는 IP주소 대역의 접속을 금지하거나
방화벽, 라우터에서 해당 접속을 금지시킨다.

UDP Flooding
-비연결형 프로토콜인 UDP를 사용하여 UDP패킷은 수신자 측에서 검증 절차가 없기 때문에 
공격자는 패킷의 크기, Source IP를 모두 위조 할 수 있어 추적하는 것이 제한적이다.
-패킷의 크기를 키우기 위해 패킷의 데이터가 쓰레기 값들로 이루어져있다.
-패킷의 크기가 일정하다.
-보통 80번 포트인 HTTP를 공격한다.

UDP Flooding 대응방안
1. 충분한 대역폭 확보 : 공격 트래픽보다 더 큰 규모의 회선 대역폭을 확보
2. 미사용 프로토콜 필터링 : 회사에서 사용하는 네트워크와 서비스 구조에 따라 UDP를 이용하는 포트를 차단
3. 위조된 IP 차단 : 공인 IP로 사용될 수 없는 형식의 IP들을 방화벽으로 차단
4. 패킷 크기 기반 차단 : 특정 크기 이상의 UDP패킷을 차단
5. Ingress 필터링 및 Egress 필터링 : 연결된 라우터 간에 사용하는 IP 대역 정보를 알고있기 때문에 Source IP가 상대방 라우터
에서 사용 가능한 대역인지 파악 후 차단하는 기능

7계층 DoS공격의 특징
-변조된 IP가 아닌 정상 IP를 이용하여 탐지가 어렵다.
-소량의 트래픽을 이용하여 오랜시간 공격이 진행되어 탐지가 어렵다.

웹어플리케이션에 대한 DoS 공격 유형
-HTTP GET Flooding공격 : TCP로 정상적으로 접속한 뒤 HTTP의 GET Method를 통해 특정 페이지를 무한대로 실행
-HTTP CC공격 : 웹 서버가 캐시를 사용하지 않고 응답하게 하는 공격
-동적 HTTP Request Flooding공격 : 요청 페이지를 변경하여 웹 페이지를 지속적으로 요청
-Slow HTTP Header Dos공격 : 서버로 전달할 HTTP메세지의 Header정보를 비정상적으로 조작하여 웹서버가 헤더 정보를
완전히 수신할 때까지 연결을 유지시키는 공격 , 불안전한 메시지를 수신했기 때문에 로그가 남지 않는다.
-Slow HTTP Post공격: 웹서버와의 연결을 장시간 유지하여 웹서버가 정상적인 이용자의 접속을 받아들일 수 없게한다.

DDoS
-DoS공격이 발전된 것, 대응이 어렵다.

DDoS 기본 구성
공격자 : 공격을 주도하는 해커의 컴퓨터
마스터 : 공격자에게 직접 명령을 받는 시스템, 여러대의 에이전트를 관리
핸들러 프로그램 : 마스터 시스템 역할을 수행하는 프로그램
에이전트 : 공격 대상에 직접 공격을 가하는 시스템
데몬 프로그램 : 에이전트 시스템 역할을 수행하는 프로그램

DDoS 진행과정
1. 관리자 계정을 획득하고, 스니핑이나 버퍼 오버플로우등의 공격으로 루트 권한을 획득한다.
2. 네트워크 스캐닝으로 취약한 서비스를 제공하는 서버를 파악한다.
3. 실제 공격을 위한 Exploit을 작성한다.
4. 권한을 획득한 시스템에 침투하여 Exploit을 컴파일 하여 설치한 뒤 공격한다.
================================================================================
스캐닝 공격
-공격자가 모든 포트가 열려있는지 닫혀있는지 파악하기 위해 하는 공격
-Source IP가 모두 동일하다.

TCP Open 스캔
-TCP를 이용한 가장 기본적인 스캔

포트가 열린 경우 SYN, SYN+ACK, ACK 수행
포트가 닫힌 경우 SYN, RST+ACK 수행

스텔스 스캔
특징 : 포트가 열린경우 응답이 없고, 닫힌경우 RST패킷이 돌아온다.
FIN 스캔 : FIN 플래그를 설정하여 보낸 패킷
NULL 스캔 : 플래그 값을 설정하지 않고 보낸 패킷
XMAS 스캔 : ACK, FIN, RST ,SYN 플래그 모두를 설정하여 보낸 패킷

UDP스캔
-포트가 열린경우 서버가 아무것도 보내지 않지만, 닫혀있는 경우 ICMP unreachable패킷을 보낸다.

===================================================================================
대역폭 공격

ICMP Flooding
-ICMP는 인터넷 환경에서 오류에 관한 처리를 지원하는 역할 ex) ping
-패킷의 크기를 키우기 위해 패킷의 데이터가 쓰레기 값들로 이루어져있다.
-패킷의 크기가 일정하다.
-Source IP가 랜덤하다.

ICMP Flooding 대응 방안
1. 충분한 대역폭 확보 : 공격 트래픽보다 더 큰 규모의 회선 대역폭을 확보
2. 위조된 IP 차단 : 공인 IP로 사용될 수 없는 형식의 IP들을 방화벽으로 차단
3. 패킷 크기 기반 차단 : ICMP 크기를 네트워크에 따라 적절한 임계치를 적용하여 차단
4. 미사용 프로토콜 필터링 : ICMP는 헬스 체크의 목적으로만 사용하기 때문에 가능하다.

Reflection Attack
-인터넷에서 UDP 서비스를 사용하는 서버들을 매개체로 이용하여 DDos를 발생시키는 공격 네트워크 대역폭을 고갈시키는 공격
-요청 패킷과 응답 패킷의 형상이 반사되는 형태를 보이며 증폭되는 형태를 보이기때문에 증폭공격이라고도 한다.
-매개체 서버, 공격 대상 서버가 피해자

진행과정
1. 공격자가 C&C를 이용하여 좀비 PC들에게 공격명령 전송
2. 많은 좀비 PC들이 Source IP를 공격 대상의 IP로 위조하고 특정 매개체가 되는 서버들로 UDP요청 패킷들을 전송
3. 요청 패킷을 수신한 매개체 서버들이 공격 대상이 되는 IP로 대량의 응답 패킷들을 전송

공격 대상 입장 특징
- 대부분 UDP 프로토콜로 구성된다.
- 대량의 패킷들은 응답 패킷이다.
- 출발지 포트 정보를 통해 어떤 UDP 서비스 서버가 매개체로 사용된 것인지 알 수 있다.

매개체 입장 특징
- 운영중인 UDP서비스로 많은 요청 패킷이 발생
- 출발지 IP는 1-2개로 적음
- 목적지 포트는 매개체 서버에서 운영중인 UDP 서비스의 포트 번호

반사공격 종류
1. DNS 반사공격
-큰 응답값을 만들기 위해서 DNS 레코드를 TXT 또는 ANY형태로 질의해야한다.
-DNS는 응답 크기가 512bytes를 초과하면 TCP로 전환되는 특징이 있지만 공격자는 위조된 Source IP를 사용하고 있기 때문에
TCP로 재질의를 할 수 없기 때문에 큰 응답사이즈를 가진 도메인 Auth DNS서버를 준비한다.

DNS 반사공격 진행과정
1. 공격자가 C&C를 이용하여 좀비 PC들에게 공격명령 전송
2. 좀비 PC들은 출발지 IP 주소를 공격 대상 IP주소로 위조하여 다수의 캐싱 DNS에게 DNS질의 수행(ANY나 TXT사용)
3. 캐싱 DNS에서 사전에 캐싱되어 있지 않은 도메인이면, 캐싱 DNS는 Auth DNS에게 질의 하여 캐싱 수행
4. +bufsize나 +ignore옵션이 사용되어 패킷 크기가 크더라도 UDP로 유지되어 공격 대상에게 공격 수행

공격 대상 입장 대응 방법
1. 미사용 프로토콜 차단 : 운영중인 네트워크 내에서 UDP를 사용하지 않는다면 전면 차단
2. Auth DNS가 공격 대상일 경우, 수신하는 응답 패킷 차단 : resolv.conf에 설정된 IP주소를 제외한 모든 DNS응답 패킷을 차단

매개체 입장 대응 방법
1.ANY , TXT같은 레코드는 거의 사용되지 않기 때문에, 사용하지 않을 경우 전면 차단하거나 임계치 초과 시 차단하도록 설정

2.SSDP 반사 공격
-IoT기기를 매개체로 하는 반사 공격이며 UPnP기능을 사용한다.

UPnP : 네트워크에 특정 기기를 추가할 때 네트워크 상에서 추가된 기기를 자동으로 인식하게 도와주는 기능
SSDP는 네트워크 상에서 서비스나 정보를 찾기 위한 프로토콜이고, UDP프로토콜과 1900번 포트를 사용한다.
SSDP는 UDP에 속해 있지만, 헤더 구조상에 HTTP프로토콜이 사용되는 특이한 구조를 가지고 있다.

SSDP 반사공격 진행과정
1. 공격자가 C&C를 이용하여 좀비 PC들에게 공격명령 전송
2. 좀비 PC들은 출발지 IP를 공격 대상의 IP로 위조하여 수많은 UPnP기기들을 매개체로 M-SEARCH를 이용한 요청 값을 전송
3. M-SEARCH를 수신한 기기들은 응답 값을 공격 대상에게 전송하여 네트워크 대역폭을 고갈시킨다.

SSDP 반사 공격 특징
-UDP를 사용한다
-출발지 포트가 1900번이다
-출발지 IP주소들은 실제 UPnP기기들이다.
-공격 대상이 수신한 응답 패킷은 UDP임에도 HTTP/1.1 200 OK라는 값이 사용된다. => SSDP가 HTTPU에 속하기 때문이다.
-Location 헤더에 실제 기기의 세부정보를 보여주는 링크가 포함된다.

공격 대상 입장 대응 방법
1. 운영중인 네트워크에서 UPnP기기들이 사용되지 않는다면 출발지 포트가 1900번인 UDP패킷을 차단한다.
2. UDP임에도 HTTP/1.1 200 OK를 포함한 패킷을 시그니쳐로 등록하여 차단한다.

매개체 입장 대응 방법
1. 공인 IP주소로 설정되어 사용하는 기기들을 사설 IP로 변경하여 사용한다.
2. UPnP기능을 사용하지 않는 기기들은 기기들의 설정화면을 제공하지 않도록 비활성화 한다.

===================================================================================
시각화 전략
-사용자 : 실제 이용자를 대상으로 시각화를 해야한다.
-통계 그래프 기법
-기술적 고려사항 : 의사결정이 쉽도록 많은 양의 트래픽 또는 로그들을 전반적으로 표현한다.

공격관련 중요변수
1. Source Destination IP 주소
2. 목적지 포트번호
3. 패킷의 평균 크기
4. TCP헤더의 플래그 및 IP헤더의 프로토콜 필드

시각화의 장점
-많은 양의 정보를 종합적으로 해석 가능
-빠르게 상황을 인식할 수 있다.

utmp로그
-utmp데몬을 사용하여 파일에 로그를 남긴다.
-who,w같은 명령어를 사용하여 로그를 출력한다.

w : 현재 시스템에 로그인된 사용자 계정과 로그인 셸종류, 로그인 시간 등을 나타낸다.
who : 접속한 시스템의 IP확인

wtmp로그
-wtmp데몬을 사용하여 파일에 로그를 남긴다.
-utmp와 비슷한 역할, 사용자들의 로그인, 로그아웃, 시스템 재부팅 정보 수록
-last명령어를 사용하여 확인 가능

su로그
-권한 변경에 대한 로그
-설정파일 : /etc/default/su

pacct 로그
-시스템에 로그인한 모든 사용자가 수행한 프로그램에 대한 정보를 저장하는 로그
-acctcom 명령으로 확인 가능
-lastcomm : 실행된 날짜 출력

syslog : 시스템의 로그 정보를 대부분 수집하여 로깅
authlog/loginlog : 실패한 로그인 시도에 대한 로깅 수행

시스템 이벤트 로그 : 윈도우 시스템에서 시스템 로그가 이벤트 형식으로 관리됨
=========================================================
BPS : 1초동안 전송할 수 있는 모든 비트의 수